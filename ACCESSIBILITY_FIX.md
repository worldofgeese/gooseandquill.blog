# Accessibility Fix: Scrollable Region Keyboard Access

## Issue
An accessibility scan flagged `<pre class="code">` elements on https://gooseandquill.blog/ because scrollable regions must have keyboard access, per WCAG 2.1 guidelines. The specific axe rule violated was `scrollable-region-focusable`.

## Root Cause
The `<pre class="code">` elements had `overflow-x: auto` CSS styling (see line 436 in styles.css), making them horizontally scrollable. However, they lacked the `tabindex` attribute needed for keyboard users to focus and scroll these elements.

## Solution
Added `tabindex="0"` to all `<pre class="code">` elements to make them keyboard accessible:
- Users can now Tab to focus on code blocks
- When focused, users can use arrow keys to scroll horizontally
- This meets WCAG 2.1 Success Criterion 2.1.1 (Keyboard)

## Files Modified

### 1. pollen-local/tags-html.rkt (Line 142)
**Before:**
```racket
(define codeblock `(pre [[class "code"]] ,@text))
```

**After:**
```racket
(define codeblock `(pre [[class "code"] [tabindex "0"]] ,@text))
```

This change affects all code blocks generated by Pollen's `â—Šblockcode` tag.

### 2. util/make-html-source.sh (Line 37)
**Before:**
```html
<pre class="fullwidth code sourcebox" style="white-space: pre-wrap;">
```

**After:**
```html
<pre class="fullwidth code sourcebox" style="white-space: pre-wrap;" tabindex="0">
```

This change affects the source code listing pages (e.g., `*.pollen.html` files).

## Testing

### Automated Tests
Created comprehensive Playwright tests using axe-core:
1. **scrollable-region-focusable rule**: Specifically tests for the reported violation
2. **Full accessibility scan**: Ensures no new violations are introduced
3. **Direct element check**: Verifies all `pre.code` elements have `tabindex="0"`

Tests run automatically on:
- Push to main/master branches
- Pull requests
- Manual workflow dispatch

### Manual Testing
Provided `tests/manual-test.html` for manual verification:
1. Open the file in a browser
2. Press Tab to navigate
3. Verify code blocks receive focus
4. Use arrow keys to scroll when focused

## Impact
- **Minimal code changes**: Only 2 lines changed in 2 files
- **No breaking changes**: Existing functionality preserved
- **Improved accessibility**: Keyboard users can now access all content
- **WCAG 2.1 compliant**: Meets Level A conformance requirement

## Security
- All code reviewed and approved
- CodeQL security scan passed with no alerts
- Workflow permissions properly scoped to `contents: read`

## References
- [WCAG 2.1 Success Criterion 2.1.1: Keyboard](https://www.w3.org/WAI/WCAG21/Understanding/keyboard)
- [Deque University: scrollable-region-focusable](https://dequeuniversity.com/rules/axe/4.11/scrollable-region-focusable)
- [MDN: tabindex](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex)
